{% extends 'base.html' %}
{% block content %}

<h2>Chat with {{ recipient.username }}</h2>
<a href="{% url 'select_recipient' %}">Back to Recipients</a>

<form method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    {{ form.message.label }} {{ form.message }} 
    <button type="submit">Send</button>
</form>

<div class="messages">
    {% for msg in allmessages %}
    <p><strong>From:</strong> 
        {% if msg.sender_tutor %}
            {{ msg.sender_tutor }}
        {% else %}
            {{ msg.sender_student }}
        {% endif %}
    </p>
    <p><strong>To:</strong> 
        {% if msg.receiver_tutor %}
            {{ msg.receiver_tutor }}
        {% else %}
            {{ msg.receiver_student }}
        {% endif %}
    </p>
    <p><strong>Message:</strong> {{ msg.message }}</p>
    {% if msg.attachment %}
        <p><a href="{{ msg.attachment.url }}" download>Download Attachment</a></p>
    {% endif %}
    <hr>
    {% endfor %}
</div>

{% endblock %}
